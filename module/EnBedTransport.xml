<?xml version="1.0" encoding="utf-8"?>
<module name="Patient Transport" type="onload" trigger="BedList,grdInternalBedRequests">
<facet name="FileName" value="BedTransport"/>
<!-- Internal Bed Requests -->
<section type="tab" name="tabBedRequests" title="Transportation Requests">
    <group>
        <row>
					<control type="buttongroup"
						name="btngrpBedRequestStatus"
						span="10"
						default="Open"
						source="Open,Requested,Approved,Progress,Completed,Rejected,Canceled"
						sourcelabels="Open,Requested,Approved,In Progress,Completed,Rejected,Canceled"
						provoke="grdTransportRequests"/>
        </row>
        <row>
					<control 
						type="datagrid"
						label="Transport Requests"
						name="grdTransportRequests"
						rows="20" span="12"
						fitrows="true"
						action="redirect"
						target="BedRequestTabModal"
						searchable="true"
						acctsvcreq="true"
						rowcolor="Priority|1=green;2=yellow;3=red"
						datarequest="GetFacilityBedRequests"
						appendrequest="transportRequired=true,transportStatus=[btngrpBedRequestStatus]"
						source="DateTimeEntered,TransportDateTime,WardName,RoomName,ExpectedLengthOfStay,PatientFullName,RequestNotes,RequestingFacilityName,RequestingFromFacilityName,Status"
						sourcelabels="Entered,Transport,Ward,Room,Days,Patient,Notes,Requested by,Requested From,Status"
						align="||left|left|left|left|left|left|left|left"
						format="datetime_short|datetime_short"
						sort="TransportDateTime=desc"
						key="RequestGuid"
						onselectset="RequestGuid=[[RequestGuid]]"
						onselect="RequestGuid"/>
        </row>
    </group>
</section>

<!-- Tabmodal for entering/editing bed requests -->
<section type="tabmodal" badge="none" name="BedRequestTabModal" title="Transportation Request" size="small">
    <group name="RequestGuids" showif="never">
        <row>
            <control type="hidden" 
              name="RequestGuid"
              acctsvcreq="true"
              datarequest="GetFacilityBedRequests"
              appendrequest="requestGuid=[RequestGuid]"
              inject="grpBedRequestInfo,grpTransportInfo"
              provoke="GetPatientInfo,TransportForms"/>

            <control type="hidden" name="GetPatientInfo"
              datarequest="GetPatientAllFields"
              appendrequest="PatientId=[Nrq_PatientId]"
              inject="grpRequestPatientInfo"/>
        </row>
    </group>
    <group name="grpRequestPatientInfo" bgcolor="lightgrey">
        <row>
          <control type="hidden" name="Bed_HasOpenVisit"/>
          <control type="hidden" name="Bed_PatientVisit"/>
        </row>
        <row>
          <control type="label" label="Account" span="3" align="left"/>
          <control type="label" label="Name"	 align="left" span="3"/>
          <control type="label" label="Parent"	 align="left" span="3"/>
          <control type="label" label="Maternal"	 align="left" span="3"/>
          
        </row>
        <row>
          <control type="text" name="Bed_AccountNumber" span="3"/>
          <control type="text" name="Bed_PatientFirstName" span="3"/>
          <control type="text" name="Bed_PatientMiddleName" span="3"/>
          <control type="text" name="Bed_PatientLastName" span="3"/>
        </row>
        <row>
          <control type="label" label="Birth"	 span="2" />
          <control type="date" name="Bed_PatientDOB" span="2"/>
          <control type="text" name="Bed_PatientAge" span="2"/>
          <control type="label" label="Sex"	 span="1" />
          <control type="select" 
            name="Bed_PatientSex" span="3"  
            source="Male,Female,Indeterminate"   
            sourcelabels="Male,Female,Indeterminate"	/>
          <control type="button" name="btnPatientChart" span="2"
            icon="folder-open-alt"
            label="Tab" action="redirect" target="PatientTabModal"
            preset="Review_PatientId=[Nrq_PatientId]" trigger="Review_PatientId"/>
        </row>
        <row name="rowHasOpenVsit" reveal="Bed_HasOpenVisit=true">
            <control type="label" label="Current Bed" span="2"/>
            <control type="text" name="RoomFullName" span="5"/>
        </row>
    </group>
    <group name="grpBedRequestInfo" bgcolor="lightgrey">
        <row>
          <control type="hidden" name="Nrq_PatientId"/>
        </row>
        <row>
            <control type="label" span="2" label="Status"	/>
            <control type="select" name="Nrq_Status" span="4"
                source="Active,Approved,Completed,Rejected,Canceled"
                sourcelabels="Active,Approved,Completed,Rejected,Canceled"
                default="Active"/>
            <control type="label" span="3" label="Date Generated"/>
            <control type="datetime" name="Nrq_DateTimeEntered" span="3"/>
        </row>
        <row>
            <control type="label" label="Hospital of Destination" span="2"/>
            <control type="select"
              span="4"
              acctsvc="true" 
              name="Nrq_RequestingFromFacility" 
              namefield="RequestingFromFacilityName" 
              datasource="GetTransferHospitalsActive" 
              source="HospitalName,HospitalGuid"/>
            <control type="label" label="Hospital of Origin" span="2"/>
            <control type="select"
              span="4"
              acctsvc="true" 
              name="Nrq_RequestingFacility" 
              namefield="RequestingFacilityName" 
              datasource="GetTransferHospitalsActive" 
              source="HospitalName,HospitalGuid"/>
        </row>
        <row>
					<control type="label" span="2" label="Diagnosis"	/>
					<control type="textarea" name="Nrq_PrimaryDiagnosis" span="10" rows="1" />
        </row>
        <row>
            <control type="label" span="2" label="Priority"	/>
            <control type="select" name="Nrq_Priority" span="4" 
              source="1,2,3" sourcelabels="Normal,Medium,Critical"	/>
            <control type="label" span="2" label="DRG Group"/>
            <control type="text" name="Nrq_DRG" span="4"/>
        </row>
        <row>
            <control type="label" span="3" label="Required Equipment"/>
            <control type="textarea" name="Nrq_RequiredEquipment" rows="1" span="9"/>
        </row>
        <row>
            <control type="label" span="3" label="Application Notes"/>
            <control type="textarea" name="Nrq_RequestNotes" rows="1" span="9"/>
        </row>
        <row >
            <control type="label" span="3" label="Request for"/>
            <control type="datetime" name="Nrq_DateTimeRequestedFor" span="3"/>
            <control type="label" span="4" label="Estimated Duration" badge="días"/>
            <control type="text" name="Nrq_ExpectedLengthOfStay" span="2"/>
        </row>
        <row>
          <control type="label" span="3" label="Reserve Room"/>
          <control type="select" name="Nrq_Ward" 
            span="4"  
            acctsvc="true"
            datasource="GetHospitalWardsForThisFacilityActive" 
            source="Ward,WardGuid"/>
          <control type="label" label="Bed"	 span="2"/>
          <control type="select" name="Nrq_Room" 
            span="3" readonly="true"
            namefield="Nrq_RoomName"
            acctsvc="true"
            datasource="GetFacilityPatientRoomsAndBedsForThisFacility"
            source="RoomAndBedNumber,RoomGuid"/>
        </row>
        <row>
          <control type="label" span="3" label="Response Notes"/>
          <control type="textarea" name="Nrq_ResponseNotes" rows="1" span="9"/>
        </row>
      </group >
      <group name="grpTransportInfo" bgcolor="lightgrey">
        <row>
          <control type="label" span="3" label="Required"/>
          <control type="buttongroup" name="Nrq_TransportRequired"
            source="True,False" sourcelabels="Yes,No"	 span="3" edit="true"/>
          <control type="label" label="Rescue" span="3"/>
          <control type="buttongroup" name="Nrq_IsRescue" source="True,False" sourcelabels="Yes,No"	 span="3" required="true" edit="true"/>
        </row>
        <row>
          <control type="label" label="Date of Transport" span="3"/>
          <control type="datetime" name="Nrq_TransportDateTime" span="3" default="now" edit="true"/>
          <control type="label" label="Transportation Status" span="3"/>
          <control type="select" name="Nrq_TransportStatus" span="3" edit="true"
            source="Open,Requested,Approved,Progress,Completed,Rejected,Canceled"
            sourcelabels="Unsolicited,Requested,Approved,In Progress,Completed,Rejected,Canceled"/>
        </row>
        <row name="rowRejected" reveal="Nrq_TransportStatus=Rejected">
          <control type="label" label="Reason for Rejection" span="3"/>
          <control type="textarea" name="Nrq_ReasonForReject" span="9" rows="1" required="true" edit="true"/>
        </row>
        <row>
          <control type="label" span="3" label="Transportation Notes"/>
          <control type="textarea" name="Nrq_TransportNotes" rows="1" span="9" edit="true"/>
        </row>
        <row>
          <control type="label" label="" span="5"/>
          <control type="button" 
            name="btnCloseBedRequest"
            span="3"
            size="large"
            color="grey"
            label="Close"	
            action="close|new"/>
          <control type="button"
            name="btnUpdateBedRequest"
            label="Update"	
            span="3"
            size="large"
            color="grey"
            icon="cloud-upload"
            action="save|close|new"
            acctsvc="true"
            affector="none"
            capture="grpTransportInfo"
            confirm="Please confirm you want to update this transportation request"
            dataupdate="UpdateFacilityBedRequests"
            appendupdate="requestGuid=[RequestGuid]"
            provoke="grdTransportRequests"/>
        </row>
				<row>
				<control type="datagrid" label="Transportation Documents" name="TransportForms"
          span="12" rows="3"
          fitrows="true"
          action="redirect|url" 
          target="ecd/index.html"
          usesource="login"
          filter="FormName=Ambulance Transfer"
          append="ecdGuid=[[rowGuid]],patientid=[Nrq_PatientId],ecdMode=review" 
          datarequest="GetCompletedPatientFormsForPriorVisits"
          appendrequest="PatientId=[Nrq_PatientId]"
          source="DateTimeEntered,RevisionId,Type,FormName,FullUserName"
          sourcelabels="Date/Time,Modified,Type,Document,Signed by"	
          align="left|left|left|left|left"
          format="datetime|boolean"
          translate="Type"
          sort="DateTimeEntered=desc"
          key="rowGuid">
          <control type="button" name="btnTransportRequest"
              reveal="[Nrq_PatientId]!"
              icon="cloud-upload" color="green"
              label="Add New"	
              onclose="Advertencia: No ha guardado este documento. ¿Todavía quiere salir?"
              action="redirect|url" 
              target="ecd/index.html" 
              usesource="login"
              append="ecdGuid=9DD32563-DA19-47B9-AF7D-617E6FACB53C,patientid=[Nrq_PatientId],patientvisit=[Bed_PatientVisit]"/>
            <control type="button" name="reviseRequestECD" 
              action="redirect|url" 
              target="ecd/index.html"
              usesource="login"
              mode="ecd"
              append="patientid=[Nrq_PatientId],patientvisit=[Bed_PatientVisit],ecdMode=revise,ecdGuid=[[rowGuid]]" 
              showif="feature"
              confirm="Please confirm you want to revise this document"
              label="Revise"
              icon="refresh"
              trigger="ButtonGroupSelect"
              provoke="TransportForms"/>
            <control type="button" name="printRequestECD2" action="print"
              usesource="login" mode="ecd" showif="feature"
              append="patientid=[Nrq_PatientId],patientvisit=[Bed_PatientVisit],ecdGuid=[[rowGuid]]"
              label="Print"	
              icon="print"/>
            <control type="button" name="CancelRequestECDs" 
              action="save"
              affector="none"
              showif="feature"
              color="Orange"
              confirm="Caution! You are canceling this document. Please confirm you want to continue."
              datainsert="UpdateCompletedPatientFormSetStatusToCanceledByRowguid"
              appendinsert="formGuid=[[rowGuid]],userId=(userName)"
              label="Cancel"	
              icon="thumbs-down-alt"
              provoke="TransportForms"/>
        </control>
				</row>
      </group>
</section>

<section type="tabmodal" badge="none" name="PatientTabModal" title="Patient Information"	>
    <group name="ReviewGuidStorage" showif="never">
      <row>
        <control type="text" span="4" name="Review_PatientId"
          datarequest="GetPatientAllFields"
          appendrequest="PatientId=[Review_PatientId]"
          inject="ReviewPatientInfo"
          provoke="ERProblemList"/>
      </row>
    </group>
    <group name="ReviewPatientInfo">
        <row>
          <control type="hidden" name="Review_HasOpenVisit"/>
          <control type="hidden" name="Review_PatientVisit"/>
        </row>
        <row>
            <control type="label" label=""	 span="1"/>
            <control type="label" label="Name"	 align="left" span="3"/>
            <control type="label" label="Parent"	 align="left" span="3"/>
            <control type="label" label="Maternal"	 align="left" span="3"/>
            <!--Save patient information-->
            <control type="button" 
              name="Review_PatientUpdate"
              reveal="Review_PatientId!" 
              span="2" 
              label="Update"	
              affector="none"
              capture="ReviewPatientInfo" 
              icon="cloud-upload"
              action="save|close"
              confirm="Please confirm you want to update this patient."	
              datainsert="UpdatePatient"
              appendinsert="PatientId=[Review_PatientId]"
              provoke="PatientList"/>
          </row>
          <row>
            <control type="label" label=""	 span="1"/>
            <control type="text" name="Review_PatientFirstName" span="3" required="true" edit="true"  />
            <control type="text" name="Review_PatientMiddleName" span="3" required="true" edit="true"  />
            <control type="text" name="Review_PatientLastName" span="3" edit="true" />
          </row>
          <row>
            <control type="label" label="Birth"	 span="2" />
            <control type="date" name="Review_PatientDOB" span="2" required="true" edit="true"/>
            <control type="text" name="Review_PatientAge" span="2" readonly="true"/>
            <control type="label" label="Sex"	 span="1" />
            <control type="select" 
              name="Review_PatientSex" span="3" 
              required="true" 
              source="Male,Female,Indeterminate"  
              edit="true" 
              sourcelabels="1 Male,2 Female,3 Undefined,4 Unknown"	/>
          </row>
          <row>
             <control type="label" label="Account"	 span="2" />
            <control type="text" name="Review_AccountNumber" span="2" />
            <control type="text" name="Review_MedicalRecordNumber" span="2" readonly="true"/>
            <control type="label" label="Marital Status"	 span="2" />
            <control type="select" name="Review_PtMaritalStatus" span="2"
              datasource="GetLookupMaritalStatus"
              source="MaritalStatus,MaritalStatus"
              explicit="true" 
              edit="true"/>
          </row>
          <row>
             <control type="label" label="Phone"	 span="2" />
            <control type="text" name="Review_PtPhoneNumber" span="3"
              placeholder="Telephone" edit="true" />
            <control type="label" label="Cell Phone"	 span="2" />
            <control type="text" name="Review_PatientCellPhone" span="3" edit="true"/>
          </row>
          <row>
            <control type="label" label="Financial Class"	 span="2"/>
            <control type="select" name="Review_FinancialClass" span="3"
              source="FONASA A,FONASA B,FONASA C,FONASA D,ISAPRE,DESCONOCIDO" edit="true" required="true"/>
            <control type="label" label="Companion"	 span="2"/>
            <control type="text" name="PrimaryPayorFirstName" span="3"
              edit="true"/>
           </row>
          <row>
            <control type="label" label="Address"	 span="2"/>
            <control type="text" name="Review_PrimaryPayorAddLineOne" span="3" edit="true"/>
            <control type="label" label="City"	 span="2"/>
            <control type="text" name="Review_PrimaryPayorCity" span="3"  edit="true"/>
          </row>
          <row> 
            <control type="label" label="Province"	 span="2"/>
            <control type="text" name="Review_PrimaryPayorAddLineTwo"  span="3" edit="true"/>
            <control type="label" label="Country"	 span="2"/>
            <control type="text" name="Review_PrimaryPayorState" span="3" edit="true"/>
          </row>
    </group>
    
    <group name="PatientGridGroup">
      <row>
        <control type="buttongroup" 
          name="ButtonGroupSelect" 
          edit="true"
          source="Problems,Allergy,Vitals,Physicians,Labs,Medication,Radiology,Surgery,EREcdForms"
          sourcelabels="Diagnosis,Allergies,Vitals,Physicians,Laboratory,Medicines,Radiology,Surgeries,Documents" 
          span="12" 
          default="Problems"  
          provoke="ERGridList,ERProblemList,ERAllergyList,ERVitalSigns,ERNeuroVitalSigns,ERBloodSugarVitalSigns,ERPhysicianAssignments,ERLabOrders,ERLabResults,Pathology,ERMedications,ERHomeMedications,ERRadiologyOrders,ERRadiologyReports,ERSurgeries,EREcdForms"/>
      </row>
      <row>
        <control name="ERGridList" affector="ButtonGroupSelect" type="options" span="12">
          <control type="datagrid" label="Active Diagnosis"	 name="ERProblemList" 
            option="Problems"
            rows="5"
            fitrows="true"
            filter="Status!Canceled"
            datarequest="GetPatientProblemsWithRelatedSymptomsByVisit"
            appendrequest="patientId=[Review_PatientId]"
            source="DateTimeEntered,ProblemType,ProblemDescription,ProblemNoteText,Status,EnteredByFullName"
            sourcelabels="Date,Type,Diagnosis,Notes,Status,Signed by"	
            translate="ProblemType,Status"
            align="left|left|left|left|left|left"
            format="datetime"
            sort="DateTimeEntered=desc"
            key="ProblemGuid"/>

          <control type="datagrid" label="Active Allergies"	 name="ERAllergyList"
            option="Allergy" 
            filter="AllergyStatus=Active"
            rows="10"
            fitrows="true"
            datarequest="GetPatientKnownAllergies"
            appendrequest="patientId=[Review_PatientId]"
            source="AllergyEnteredDateTime,Allergen,Reaction,ReactionSeverity,AllergyNote,EnteredByFullName"
            sourcelabels="Date/Time,Allergies,Reaction,Severity,Note,Signed by"	
            translate="Reaction,ReactionSeverity"
            align="left|left|left|left|left|left|left"
            format="datetime"
            sort="AllergyEnteredDateTime=desc"
            key="RecId"/>

          <control type="datagrid" label="Vital Signs" name="ERVitalSigns" 
            option="Vitals"
            rows="5"
            fitrows="true"
            datarequest="GetPatientVitalSignsDefault"
            appendrequest="patientVisit=[PatientVisit],patientId=[Review_PatientId]"
            source="DateTimeEntered,Weight,Temperature,HeartRate,SBP,DBP,Map,SpO2,Pain,FullUserName"
            sourcelabels="Date/Time,Weight (kg),Temp,Rhythm,PAS,PAD,PAM,SpO2,Pain,Signed by"
            align="|right|right|right|right|right|right|right|right|left"
            format="datetime||0.0"
            sort="DateTimeEntered=desc"
            key="RecId">
            <control type="button" 
              name="VitalGraphButton"
              icon="bar-chart"
              label="Graphs"
              action="redirect|view"
              target="vitals-graph"
              append="patientid=[Review_PatientId],patientvisit=[PatientVisitGuid],distinct=true"/>
          </control>

          <control type="datagrid" label="Neuro Vital Signs" name="ERNeuroVitalSigns" 
            option="Vitals"
             
            span="12"
            rows="5"
            fitrows="true"
            datarequest="GetPatientVitalSignsNeuro"
            appendrequest="patientVisit=[PatientVisit],patientId=[Review_PatientId]"
            source="UserDefinedDateTime,NeuroMotor,NeuroVerbal,NeuroEyeOpening,FixedReactive,GlasgowComaScale,Notes,FullUserName"
            sourcelabels="Date/Time,Engine,Verbal,Eye,Reactive,Glasgow,Notes,Signed by"
            align="left|right|right|right|right|right|right|left"
            format="datetime"
            sort="UserDefinedDateTime=desc"
            key="RecId"/>

          <control type="datagrid" label="Blood Sugar Vital Signs" name="ERBloodSugarVitalSigns"
            option="Vitals"
            
            span="12"
            rows="5"
            fitrows="true"
            datarequest="GetPatientVitalSignsBloodSugar"
            appendrequest="patientVisit=[PatientVisit],patientId=[Review_PatientId]"
            source="UserDefinedDateTime,BloodSugar,RBS,FBS,InsulinRegular,InsulinIntermediate,Notes,Status,FullUserName"
            sourcelabels="Date/Time,Glycemia,Random,Fast,Insulin,Insulin Intermediate,Notes,Status,Signed by"
            align="left|right|right|right|right|right|left|left"
            format="datetime"
            sort="UserDefinedDateTime=desc"
            key="RecId"/>

          <control type="datagrid" label="Physicians" name="ERPhysicianAssignments" 
            option="Physicians"
            
            span="12"
            rows="5"
            fitrows="true"
            datasource=""
            datarequest="GetPhysicianAssignmentsByPatientVisit"
            appendrequest="patientId=[Review_PatientId]"
            source="EnteredDateTime,ProviderType,ProviderFullName,MedicalSpecialty1,Status"
            sourcelabels="Date/Time,Type,Medical,Specialty,Status"
            translate="ProviderType,Status"
            align="left|left|left|left|left"
            format="datetime"
            sort="EnteredDateTime=desc"
            key="rowguid"/>

          <control type="datagrid" label="Active Laboratory Orders"	 name="ERLabOrders"
            option="Labs"
            
            span="12"
            rows="5"
            fitrows="true"
            filter="Status=Active"
            datarequest="GetPatientLabTestOrdersByPatientId"
            appendrequest="patientId=[Review_PatientId]"
            source="DateTimeOrdered,DateTimeScheduled,CPTDescription,OrderInstructions,OrderedByFullName"
            sourcelabels="Date/Time,Scheduled Date,Laboratory Tests,Instructions,Signed by"
            align="left|left|left|left|left|left"
            format="datetime|datetime"
            sort="DateTimeOrdered=desc"
            key="OrderGuid"/>

          <control type="datagrid" label="Laboratory Test Results"	 name="ERLabResults"
            option="Labs"
            rows="10"
            fitrows="true"
            acctsvcreq="true"
            datarequest="GetPatientLabTestResultsByPatientVisitHIS"
            appendrequest="patientId=[Review_PatientId]"
            source="DateTimeOfTest,CPTDescription,TestName,TestResultPlusUnit,NormalRange,AbnormalFlag"
            sourcelabels="Date/Time,Panels,Tests,Results,Normal,Abnormal Range"	
            align="left|left|left|left|left|left"
            format="datetime"
            sort="DateTimeOfTest=desc"
            key="TestOrderId"/>

          <control type="datagrid" 
            label="Pathology"          
            name="Pathology"
            option="Labs"
            edit="only"
            rows="5"
            fitrows="true"
            filter="Category=Pathology"
            datarequest="GetPatientImages"
            appendrequest="patientId=[Review_PatientId]"
            source="DateEntered,Category,FileName,Note,Status"
            sourcelabels="Date/Time,Category,Document,Note,Status"	
            align="left|left|left|left|left"
            format="datetime"
            translate="Category,Status"
            sort="DateTimeEntered=desc"
            key="PhotoGuid"
            action="redirect|url" 
            target="printables/uploadviewer.html" 
            usesource="login"
            append="fileGuid=[[PhotoGuid]],fileType=[[FileType]]"/>

          <control type="datagrid" label="Internal Drug Orders" 
            name="ERMedications"
            option="Medication"
            action="redirect" 
            target="MedicationDetailModal"
            filter="Type=InPatient Order"
            span="12"
            rows="5"
            fitrows="true"
            datarequest="GetPatientMedications"
            appendrequest="patientVisit=none,patientId=[Review_PatientId]"
            source="DateStarted,Type,MedsTradeName,Frequency,MedsRoute,DesiredDoseValue,DoseUnit,Status,OrderedByFullName"
            sourcelabels="Started,Type,Medications,Frequency,Via,Dose,UOM,Status,Ordered"
            align="left|left|left|left|left|left|left|left|left"
            format="datetime|datetime"
            translate="Type,Status"
            sort="DateStarted=desc"
            key="rowguid"
            onselectset="MedicationDetailGuid=[[MedsGuid]]">
          </control>

          <control type="datagrid" label="External Drug Orders" 
            name="ERHomeMedications"
            option="Medication"
            action="redirect" 
            target="MedicationDetailModal"
            filter="Type=Home Medication"
            span="12"
            rows="5"
            fitrows="true"
            datarequest="GetPatientMedications"
            appendrequest="patientVisit=none,patientId=[Review_PatientId]"
            source="DateStarted,Type,MedsTradeName,Frequency,MedsRoute,OrderedByFullName"
            sourcelabels="Started,Type,Medications,Frequency,Via,Ordered"
            align="left|left|left|left|left|left|left|left"
            format="datetime|datetime"
            translate="Type"
            sort="DateStarted=desc"
            key="rowguid"
            onselectset="MedicationDetailGuid=[[MedsGuid]]"
            onselect="MedicationDetailGuid">
          </control>

          <control type="datagrid" label="Imaging Orders" name="ERRadiologyOrders"
            option="Radiology"
            span="12"
            rows="5"
            fitrows="true"
            datarequest="GetPatientImagingOrdersByPatientId"
            appendrequest="patientId=[Review_PatientId]"
            source="DateTimeEntered,OrderNumber,OrderPriority,ImagingOrderDescription,OrderStatus,EnteredByFullName"
            sourcelabels="Date/Time,Number,Priority,Orders,Status,Ordered"
            align="left|left|left|left|left|left"
            translate="OrderPriority"
            format="datetime"
            sort="DateTimeEntered=desc"
            key="ImagingOrderGuid"/>

          <control type="datagrid" label="Imaging Reports"	 name="ERRadiologyReports"
            option="Radiology"
            rows="10"
            fitrows="true"
            action="redirect|link" 
            target="ImageViewerLink" mode="full"
            datarequest="GetPatientImagingReportsByPatientVisit"
            appendrequest="patientId=[Review_PatientId]"
            source="ReportDateTime,OrderNumber,ProcedureDescription,Report,RadiologistLastName"
            sourcelabels="Date/Time,Number,Procedure,Report,Radiologist"	
            align="left|left|left|left|left|left"
            format="datetime"
            sort="ReportDateTimes=desc"
            key="rowguid"/>

          <control type="datagrid" label="Surgeries" 
            name="ERSurgeries"
            option="Surgery"
            action="redirect" 
            target="SurgeryTabModal" 
            rows="5"
            datarequest="GetScheduledSurgeries"
            appendrequest="patientId=[Review_PatientId]"
            source="Status,DateTimeScheduled,DateTimePerformed,Description,PrimaryProcedureName,SurgeonFullName"
            sourcelabels="Status,Scheduled,Completed,Description,Primary Procedure,Surgeon"
            align="|left|left|left|left|left"
            key="SurgeryGuid"
            translate="Status"
            format="|datetime|datetime"
            onselectset="SurgeryGuid=[[SurgeryGuid]]"
            onselect="SurgeryGuid"/>

          <control type="datagrid" label="Documents"	 name="EREcdForms"
            option="EREcdForms"
            edit="only"
            span="12"
            rows="5"
            fitrows="true"
            action="redirect|url" 
            target="ecd/index.html"
            usesource="login"
            filter="MostRecent=true"
            searchable="true"
            append="ecdGuid=[[rowGuid]],patientid=[Review_PatientId],patientvisit=[PatientVisit],ecdMode=review" 
            datarequest="GetCompletedPatientFormsForPriorVisits"
            appendrequest="patientId=[Review_PatientId]"
            source="DateTimeEntered,RevisionId,Type,FormName,FullUserName"
            sourcelabels="Date/Time,Modified,Type,Document,Signed by"	
            align="left|left|left|left|left"
            format="datetime|boolean"
            translate="Type"
            sort="DateTimeEntered=desc"
            key="rowGuid">
              <control type="button" name="reviseECD" 
                action="redirect|url" 
                target="ecd/index.html"
                usesource="login"
                mode="ecd"
                append="patientid=[Review_PatientId],patientvisit=[PatientVisit],ecdMode=revise,ecdGuid=[[rowGuid]]" 
                showif="feature"
                confirm="Please confirm you want to revise this document"
                label="Revise"
                icon="refresh"
                provoke="EREcdForms"/>
              <control type="button" name="printECD2" action="print"
                usesource="login" mode="ecd" showif="feature"
                append="ecdGuid=[[rowGuid]],patientid=[Review_PatientId]"
                label="Print"	
                icon="print"/>
              <control type="button" name="CancelECD" 
                action="save"
                affector="none"
                showif="feature"
                color="Orange"
                confirm="Caution! You are canceling this document. Please confirm you want to continue."
                datainsert="UpdateCompletedPatientFormSetStatusToCanceledByRowguid"
                appendinsert="formGuid=[[rowGuid]],userId=(userName)"
                label="Cancel"	
                icon="thumbs-down-alt"
                provoke="EREcdForms"/>
          </control>
         </control>
       </row>
     </group>
   </section>
   <partial link="./EnPartial/Admin/PartialSurgeryTabModalNoEdit.xml"/>
   <partial link="./EnPartial/Admin/PartialMedicationDetailModal.xml"/>
   <partial link="./EnPartial/Admin/PartialReportModals.xml"/>
</module>
